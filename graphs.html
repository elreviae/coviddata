<!-- Developped by Maxime DES TOUCHES - 03/2020 -->
<!doctype html>
<html lang="en">
  <head>
    <title>Covid-19 Global informations</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://www.w3schools.com/lib/w3-colors-metro.css">
    
</head>
<body class="w3-metro-darken">
    <div class="w3-panel w3-metro-darken w3-margin-bottom w3-margin-top w3-bottombar w3-border-red ">
            <h2>Covid-19 Graphs informations</h2>
            <p>
                Information about the evolution of the situation on the basis of the last days. Updated every half hour.<br/>
                Data fetched from : <a href="https://www.notion.so/What-are-our-sources-4f3f962953f1418da96eae1b5fe06039" target="_blank">Coronavirus app</a>
            </p>
            <b>
                Due to the difficulty of identification and biological confirmation of all COVID-19 cases, 
                the data presented underestimate the actual number of cases.
            </b><br/>
            <b>Current day stats may be incomplete until countries submit their data.</b>
            <div class="w3-bar w3-margin-top">
                <a href="index.html" class="w3-bar-item w3-button w3-black w3-margin-right" id="tableCoronaInf"> Covid-19 Data Table</a>
                <a href="graphs.html" class="w3-bar-item w3-button w3-black w3-margin-right" id="graphsCoronaInf"> Covid-19 Graphs history</a>
                
                
                <div id="dateToday" class="w3-bar-item w3-right"></div>
            </div>
        </div>

        
        <div class="w3-bar w3-margin w3-padding">
            <button class="w3-button w3-bar-item w3-dark-grey w3-margin-right w3-right" id="clearData" >Reload Graphs Data</button>
        </div>
    

        <div class="w3-center">
            <div id="chartContainerPercents" style="width: 45%; height: 400px; display:inline-block;"></div>
            <div id="chartContainerRecovered" style="width: 45%; height: 400px; display:inline-block;"></div>
            <div id="chartContainerSick" style="width: 45%; height: 400px; display:inline-block;"></div>
            <div id="chartContainerDeaths"  style="width: 45%; height: 400px; display:inline-block;"></div>
            <div id="chartContainerInfected" style="width: 90%; height: 400px; display:inline-block;"></div>
        </div>

  
    <script src="js/jquery-3.4.1.min.js"></script>
    <script src="js/moment-with-locales.min.js"></script>
    <script src="js/jquery.canvasjs.min.js"></script>

 
    <script> //Code pour traduction date Fr
        moment.locale('en');
    </script>
    <script>
                    // Actual Date & Time
                    document.getElementById("dateToday").innerHTML =  moment().format("dddd DD MMMM YYYY - HH:mm");
    </script>

    <script>
                        var jsonData = 'https://raw.githubusercontent.com/l-portet/coronavirus-data/master/data/history.json';
                        
                        // ------------------------------------ canvasjs
                            var dataPoints1 = [];

                            var options1 =  {
                                exportEnabled: true,
                                zoomEnabled:true,
                                animationEnabled: true,
                                theme: "dark1",
                                title: {
                                    text: "Evolution of deaths",
                                    fontSize: 16,
                                    fontFamily: "tahoma",
                                },
                                axisX: {
                                    valueFormatString: "DD MMM YY",
                                    // valueFormatString: "#",
                                    labelAutoFit: true,
                                },
                                axisY: {
                                    title: "Deaths",
                                    titleFontSize: 14,
                                    includeZero: false,
                                    valueFormatString: "#",
                                },
                                data: [{
                                    type: "splineArea",
                                    color: "#ff1a8c",
                                    yValueFormatString: "#",
                                    dataPoints: dataPoints1, lineColor:"#ff0097", markerColor:"#ff4da6"
                                        
                                }]

                               
                            };

                            function addData1(data1) {
                                for (var i = 0; i < data1.length; i++) {
                                    dataPoints1.push({
                                        // x: new Date(data[i].date),
                                        // y: data[i].units
                                        x: new Date(data1[i].createdAt),
                                        y: data1[i].dead
                                    });
                                }
                                $("#chartContainerDeaths").CanvasJSChart(options1);
                            }

                            

                        $.getJSON(jsonData, addData1);


                        // ------ Chart 2

                        var dataPoints2 = [];

                        var options2 =  {
                                exportEnabled: true,
                                zoomEnabled:true,
                                animationEnabled: true,
                                theme: "dark1",
                                title: {
                                    text: "Overall evolution",
                                    fontSize: 16,
                                    fontFamily: "tahoma",
                                },
                                subtitles: [{
                                    text: "Total of sick + recovered + deaths",
                                    fontSize: 14,
                                    fontFamily: "tahoma",
                                }],
                                
                                axisX: {
                                    valueFormatString: "DD MMM YY",
                                    // valueFormatString: "#",
                                    labelAutoFit: true,
                                },
                                axisY: {
                                    title: "Infections",
                                    titleFontSize: 14,
                                    includeZero: false,
                                    valueFormatString: "#",
                                },
                                data: [{
                                    type: "splineArea",
                                    color: "rgba(239, 244, 255, 0.6)",
                                    yValueFormatString: "#",
                                    dataPoints: dataPoints2, lineColor:"#eff4ff", markerColor:"white"
                                        
                                }]
                        };

                        function addData2(data2) {
                                for (var i = 0; i < data2.length; i++) {
                                    dataPoints2.push({
                                        // x: new Date(data[i].date),
                                        // y: data[i].units
                                        x: new Date(data2[i].createdAt),
                                        y: data2[i].infected
                                    });
                                }
                                $("#chartContainerInfected").CanvasJSChart(options2);

                            }

                        $.getJSON(jsonData, addData2);


                        

                        // ------ Chart 3

                        var dataPoints3 = [];

                        var options3 =  {
                                exportEnabled: true,
                                zoomEnabled:true,
                                animationEnabled: true,
                                theme: "dark1",
                                title: {
                                    text: "Evolution of recovered cases",
                                    fontSize: 16,
                                    fontFamily: "tahoma",
                                },
                                
                                axisX: {
                                    valueFormatString: "DD MMM YY",
                                    // valueFormatString: "#",
                                    labelAutoFit: true,
                                },
                                axisY: {
                                    title: "Recovered",
                                    titleFontSize: 14,
                                    includeZero: false,
                                    valueFormatString: "#",
                                },
                                data: [{
                                    type: "splineArea",
                                    color: "rgba(0, 163, 0, 0.6)",
                                    yValueFormatString: "#",
                                    dataPoints: dataPoints3, lineColor:"#00a300", markerColor:"lightgreen"
                                        
                                }]
                        };

                        function addData3(data3) {
                                for (var i = 0; i < data3.length; i++) {
                                    dataPoints3.push({
                                        // x: new Date(data[i].date),
                                        // y: data[i].units
                                        x: new Date(data3[i].createdAt),
                                        y: data3[i].recovered
                                    });
                                }
                                $("#chartContainerRecovered").CanvasJSChart(options3);

                            }

                        $.getJSON(jsonData, addData3);


                        // ------ Chart 4

                        var dataPoints4 = [];

                        var options4 =  {
                                exportEnabled: true,
                                animationEnabled: true,
                                theme: "dark1",
                                title: {
                                    text: "Overall percentages of sick, recovered and deaths",
                                    fontSize: 16,
                                    fontFamily: "tahoma",
                                },
                                subtitles: [{
                                    text: "From latest updates",
                                    fontSize: 14,
                                    fontFamily: "tahoma",
                                }],
                                legend:{
                                    cursor: "pointer",
                                },
                                data: [{
                                    type: "doughnut",
                                    innerRadius: 80,
                                    showInLegend: true,
                                    toolTipContent: "<b>{name}</b>: {y} (#percent%)",
                                    indexLabel: "{name} - #percent%",
                                    dataPoints: dataPoints4
                                }]
                        };

                        function addData4(data4) {
                                dataPoints4.push(    
                                    { y: data4[0].dead, name: "Deaths", label: "Deaths", color: "#ff0097" },
                                    { y: data4[0].sick, name: "Sick", label: "Infectés", color: "#2196f3" },
                                    { y: data4[0].recovered, name: "Recovered", label: "Recovered", color: "#00a300" },
                                );
                            
                                $("#chartContainerPercents").CanvasJSChart(options4);
                        }

                    
                        $.getJSON(jsonData, addData4);



                        // ------ Chart 5
                        var dataPoints5 = [];

                        var options5 =  {
                                exportEnabled: true,
                                zoomEnabled:true,
                                animationEnabled: true,
                                theme: "dark1",
                                title: {
                                    text: "Evolution of sick cases",
                                    fontSize: 16,
                                    fontFamily: "tahoma",
                                },
                                subtitles: [{
                                    text: "Data from the 03/15/2020",
                                    fontSize: 14,
                                    fontFamily: "tahoma",
                                }],
                                axisX: {
                                    minimum: new Date("2020-03-14T23:55:04.942Z"),
                                    valueFormatString: "DD MMM YY",
                                    // valueFormatString: "#",
                                    labelAutoFit: true,
                                },
                                axisY: {
                                    title: "Sick",
                                    titleFontSize: 14,
                                    includeZero: false,
                                    valueFormatString: "#",
                                },
                                data: [{
                                    type: "splineArea",
                                    color: "#2196f3",
                                    yValueFormatString: "#",
                                    dataPoints: dataPoints5, lineColor:"#2196f3", markerColor:"lightblue"
                                        
                                }]
                        };

                        function addData5(data5) {
                                for (var i = 0; i < data5.length; i++) {
                                    dataPoints5.push({
                                        // x: new Date(data[i].date),
                                        // y: data[i].units
                                        x: new Date(data5[i].createdAt),
                                        y: data5[i].sick
                                    });
                                }
                                $("#chartContainerSick").CanvasJSChart(options5);

                            }


                        $.getJSON(jsonData, addData5);





                        $("#clearData").click(function(){
                            localStorage.clear();
                            location.reload();
                        });
    </script>

<footer class="w3-metro-darken w3-small w3-left">
    <p class="w3-text-dark-grey w3-margin">
        Developped by Maxime DES TOUCHES - 2020 . <a href="https://github.com/elreviae" target="_blank">Github</a>
    </p>
</footer>
</body>
</html>