<!doctype html>
    <html lang="en"> 
    <head>
        <title>CovidData - Covid-19 Pandemic informations</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="stylesheet" href="css/w3.css">
        <link rel="stylesheet" href="css/w3-colors-metro.css">
        <link href="css/tabulator_midnight.min.css" rel="stylesheet">
        <link href="css/customcss.css" rel="stylesheet">
    </head>

    <body class="w3-metro-darken">
          <div class="w3-bar w3-black">
            <a href="index.html" class="w3-bar-item w3-button w3-text-red menutitle">CovidData</a>
            <a href="datagraphs.html" class="w3-bar-item w3-button w3-hide-small">Charts</a>
            <a href="datamapregions.html" class="w3-bar-item w3-button w3-hide-small">World Map Regions</a>
            <a href="datamapcountries.html" class="w3-bar-item w3-button w3-hide-small">World Map Countries</a>
            <a href="about.html" class="w3-bar-item w3-button w3-hide-small">About</a>
            <a href="javascript:void(0)" class="w3-bar-item w3-button w3-right w3-hide-large w3-hide-medium" onclick="menuFunction()">&#9776;</a>
          </div>
          <div id="respMenu" class="w3-bar-block w3-black w3-hide w3-hide-large w3-hide-medium">
            <a href="datagraphs.html" class="w3-bar-item w3-button">Charts</a>
            <a href="datamapregions.html" class="w3-bar-item w3-button">World Map Regions</a>
            <a href="datamapcountries.html" class="w3-bar-item w3-button">World Map Countries</a>
            <a href="about.html" class="w3-bar-item w3-button">About</a>
          </div>

            <div class="w3-container">
                <p class="w3-medium">Reported daily and global Cases, Deaths and Recovered by Country, Territory or Conveyance.</p>
            </div>

            <div class="w3-row w3-padding-16">
                <div class="w3-half w3-container">
                    <select id="filterField" class="w3-select w3-border w3-left"> </select>
                </div>
                <div class="w3-half w3-container">
                    <div class="w3-bar">
                        <button id="filter-clear" class="w3-bar-item w3-button w3-mobile w3-hover-grey w3-black">Clear Filters</button>
                        <button id="pdfDownload" class="w3-bar-item w3-button w3-mobile w3-hover-red w3-black"  >Export PDF</button>
                        <button id="xlsxDownload" class="w3-bar-item w3-button w3-mobile w3-hover-green w3-black"  >Export Excel</button>
                        <button id="clearData" class="w3-bar-item w3-button w3-mobile w3-hover-grey w3-black"  >Reload Table Data</button>
                    </div>
                </div>
            </div>

            <div class="w3-row">
                <div id="covTable" class="w3-small w3-col w3-center"></div>
              </div> 

            <footer class="w3-metro-darken w3-small w3-center">
                <p class="w3-text-dark-grey w3-margin">
                    Created by Maxime DES TOUCHES - 2020 . <a href="https://github.com/elreviae" target="_blank">Github</a>
                </p>
            </footer>
            <script src="js/jquery-3.4.1.min.js"></script>
            <script src="js/moment-with-locales.min.js"></script>
            <script src="js/tabulator.min.js"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.5/jspdf.min.js"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.0.5/jspdf.plugin.autotable.js"></script>
            <script src="https://oss.sheetjs.com/sheetjs/xlsx.full.min.js"></script>
            <script src="js/customfunctions.js"></script>
            <script src="js/customtabulator.min.js"></script>
            <script src="js/maintabulator.min.js"></script>
            <script>
                $.getJSON(covApi, function(json){
                    $('#filterField').empty();
                    $('#filterField').append($('<option disabled selected>').text("Select a country"));
                    $.each(json, function(i, obj){
                        $('#filterField').append($('<option>').text(obj.country).attr('value', obj.countryInfo.iso2));
                    });
                });
                $("#filterField").change(function(){
                    covTable.setFilter("countryInfo.iso2", "like", $(this).val());
                });
                // Clear filters on click
                $("#filter-clear").click(function(){
                    $("#filterField").val("");
                    covTable.clearFilter();
                    covTable.clearHeaderFilter();
                });
                window.addEventListener('resize', function(){
                covTable.redraw();
                });
                $("#pdfDownload").click(function(){
                    covTable.downloadToTab("pdf", "CovidData.pdf", {
                    orientation:"landscape",
                    autoTable:function(doc){
                        doc.text("CovidData Report", 5, 15);
                        //return the autoTable config options object
                        return {
                            theme: 'striped',
                            tableWidth: 'auto',
                            pageBreak: 'auto',
                            rowPageBreak: 'auto',
                            styles: {
                                cellPadding: 0.5, 
                                fontSize: 8,
                            },
                            headStyles: {
                                fillColor: [26, 26, 26],
                            },
                            footStyles: {
                                fillColor: [26, 26, 26],
                            },
                            bodyStyles: {
                                fillColor: [102, 102, 102],
                                textColor: 255,
                            },
                            alternateRowStyles: {
                                fillColor: [68, 68, 68],
                            },
                            margin: {top: 20, bottom:20, left:10, right:10},
                        };
                    },
                });
            });
            $("#xlsxDownload").click(function(){
                covTable.download("xlsx", "covidData2020.xlsx", {sheetName:"covid-19 Data"});
            });
           
            $("#clearData").click(function(){
                localStorage.clear();
                location.reload();
            });
            </script>
    </body>
</html>